## 新增需求

### 需求:/sync-session 命令

系统必须提供 `/sync-session` slash command,允许用户主动触发当前会话同步到云端。

#### 场景:基本同步操作

- **当** 用户运行 `/sync-session`
- **那么** 系统必须将当前会话数据同步到七牛云,并返回会话ID

#### 场景:带 --force 参数强制覆盖

- **当** 用户运行 `/sync-session --force`
- **那么** 系统必须忽略冲突检测,直接用本地版本覆盖云端

#### 场景:带 --auto 参数启用自动同步

- **当** 用户运行 `/sync-session --auto`
- **那么** 系统必须启用后台自动同步,每 5 分钟或每 10 条新消息自动同步

#### 场景:首次同步提示配置

- **当** 用户首次运行 `/sync-session` 且未配置七牛云
- **那么** 系统必须提示用户配置 AccessKey、SecretKey 和 Bucket

#### 场景:同步成功反馈

- **当** 会话同步成功
- **那么** 系统必须显示会话ID、同步的消息数量、上传大小和访问提示

#### 场景:同步失败错误处理

- **当** 同步因网络错误或认证失败而失败
- **那么** 系统必须显示具体错误原因和建议的解决方案

### 需求:/restore-session 命令

系统必须提供 `/restore-session <session-id>` slash command,允许用户从云端恢复指定会话。

#### 场景:恢复指定会话

- **当** 用户运行 `/restore-session abc123-def456`
- **那么** 系统必须从云端下载该会话并在当前窗口恢复对话历史

#### 场景:缺少会话ID参数

- **当** 用户运行 `/restore-session` 不带会话ID
- **那么** 系统必须提示用户提供会话ID或显示最近的会话列表供选择

#### 场景:会话需要密码解密

- **当** 恢复的会话使用密码加密
- **那么** 系统必须提示用户输入解密密码

#### 场景:恢复成功反馈

- **当** 会话恢复成功
- **那么** 系统必须显示恢复的消息数量、原始设备和创建时间

#### 场景:恢复到新会话还是合并

- **当** 当前已有活动会话
- **那么** 系统必须询问用户是创建新会话还是合并到当前会话

### 需求:/list-sessions 命令

系统必须提供 `/list-sessions` slash command,列出云端所有会话。

#### 场景:列出所有会话

- **当** 用户运行 `/list-sessions`
- **那么** 系统必须显示所有云端会话的列表,包括会话ID、创建时间、最后修改时间、消息数量和设备

#### 场景:按时间排序

- **当** 用户运行 `/list-sessions`
- **那么** 系统必须按最后修改时间倒序排列会话(最新的在前)

#### 场景:带 --limit 参数限制数量

- **当** 用户运行 `/list-sessions --limit 10`
- **那么** 系统必须仅显示最近的 10 个会话

#### 场景:带 --search 参数搜索

- **当** 用户运行 `/list-sessions --search "项目名"`
- **那么** 系统必须仅显示项目路径或元数据中包含该关键词的会话

#### 场景:无会话时的提示

- **当** 云端不存在任何会话
- **那么** 系统必须提示用户"未找到任何会话,使用 /sync-session 同步当前会话"

#### 场景:显示存储使用量

- **当** 用户运行 `/list-sessions`
- **那么** 系统必须在列表末尾显示已使用的存储空间和剩余免费额度

### 需求:/delete-session 命令

系统必须提供 `/delete-session <session-id>` slash command,允许用户删除云端指定会话。

#### 场景:删除指定会话

- **当** 用户运行 `/delete-session abc123-def456`
- **那么** 系统必须从云端删除该会话的所有文件

#### 场景:删除前确认

- **当** 用户运行 `/delete-session abc123-def456`
- **那么** 系统必须先显示会话详情并要求用户确认删除

#### 场景:带 --force 参数跳过确认

- **当** 用户运行 `/delete-session abc123-def456 --force`
- **那么** 系统必须跳过确认直接删除会话

#### 场景:缺少会话ID参数

- **当** 用户运行 `/delete-session` 不带会话ID
- **那么** 系统必须提示用户提供会话ID

#### 场景:删除不存在的会话

- **当** 用户尝试删除不存在的会话
- **那么** 系统必须返回会话不存在错误

#### 场景:删除成功反馈

- **当** 会话删除成功
- **那么** 系统必须显示已删除的会话ID和释放的存储空间

### 需求:命令参数验证

系统必须验证所有 slash command 的参数。

#### 场景:无效的会话ID格式

- **当** 用户提供格式不正确的会话ID
- **那么** 系统必须返回"无效的会话ID格式"错误

#### 场景:无效的参数组合

- **当** 用户同时使用冲突的参数(如 --force 和 --auto)
- **那么** 系统必须返回参数冲突错误并提示正确用法

#### 场景:显示命令帮助

- **当** 用户运行 `/sync-session --help`
- **那么** 系统必须显示该命令的用法、参数说明和示例

### 需求:命令执行状态显示

系统必须在命令执行过程中显示清晰的状态信息。

#### 场景:显示执行进度

- **当** 命令执行耗时操作(如上传、下载)
- **那么** 系统必须显示进度条或百分比

#### 场景:显示等待状态

- **当** 命令等待网络响应
- **那么** 系统必须显示加载动画或"正在连接..."提示

#### 场景:命令可中断

- **当** 用户在命令执行过程中按 Ctrl+C
- **那么** 系统必须优雅中止操作并清理临时文件

### 需求:命令错误处理

系统必须为所有命令提供清晰的错误提示。

#### 场景:网络错误

- **当** 命令因网络问题失败
- **那么** 系统必须显示"网络连接失败,请检查网络后重试"

#### 场景:认证错误

- **当** 命令因七牛云认证失败
- **那么** 系统必须显示"认证失败,请检查 AccessKey 和 SecretKey"

#### 场景:权限错误

- **当** 命令因权限不足失败
- **那么** 系统必须显示"权限不足,请检查 Bucket 访问权限"

#### 场景:存储空间不足

- **当** 命令因存储空间不足失败
- **那么** 系统必须显示"存储空间不足,请删除旧会话或升级账户"

## 修改需求

无

## 移除需求

无
